<form [formGroup]="signupForm" (ngSubmit)="signup()" novalidate class="custom-form" >
  <h1 align="center">Registro de usuario</h1>
  <mat-form-field>
    <input matInput type="text"  formControlName="dni" placeholder="DNI" required  >
    <mat-error *ngIf="this.signupForm.get('dni').errors?.required">{{ getErrorMessage("dni") }}</mat-error>
    <mat-error *ngIf="this.signupForm.get('dni').errors?.pattern">{{ getErrorMessage("dni") }}</mat-error>
    <mat-error *ngIf="this.signupForm.get('dni').errors?.serverError">{{ this.signupForm.get('dni').errors?.serverError }}</mat-error>
  </mat-form-field>
  <mat-form-field>
    <input matInput type="text" formControlName="nombre" placeholder="Nombre" required>
    <mat-error *ngIf="this.signupForm.get('nombre').errors?.required">{{ getErrorMessage("nombre") }}</mat-error>
    <mat-error *ngIf="this.signupForm.get('nombre').errors?.minlength">{{ getErrorMessage("nombre") }}</mat-error>
  </mat-form-field>
  <mat-form-field>
    <input matInput type="text" formControlName="apellidos" placeholder="Apellidos" required>
    <mat-error *ngIf="this.signupForm.get('apellidos').errors?.required">{{ getErrorMessage("apellidos") }}</mat-error>
    <mat-error *ngIf="this.signupForm.get('apellidos').errors?.minlength">{{ getErrorMessage("apellidos") }}</mat-error>
  </mat-form-field>
  <mat-form-field>
    <input matInput type="text" formControlName="direccion" placeholder="Direcci&oacute;n" required>
    <mat-error *ngIf="this.signupForm.get('direccion').errors?.required">{{ getErrorMessage("direccion") }}</mat-error>

  </mat-form-field>
  <mat-form-field>
    <input matInput type="text" formControlName="cp" placeholder="CP" required>
    <mat-error *ngIf="this.signupForm.get('cp').errors?.required">{{ getErrorMessage("cp") }}</mat-error>
    <mat-error *ngIf="this.signupForm.get('cp').errors?.pattern">{{ getErrorMessage("cp") }}</mat-error>

  </mat-form-field>
  <mat-form-field>
    <input matInput type="text" formControlName="movil" placeholder="M&oacute;vil" required>
    <mat-error *ngIf="this.signupForm.get('movil').errors?.required">{{ getErrorMessage("movil") }}</mat-error>
    <mat-error *ngIf="this.signupForm.get('movil').dirty && this.signupForm.get('movil').errors?.pattern">{{ getErrorMessage("movil") }}</mat-error>
    <mat-error *ngIf="this.signupForm.get('movil').errors?.serverError">{{ this.signupForm.get('movil').errors?.serverError }}</mat-error>
  </mat-form-field>
  <mat-form-field>
    <input matInput type="text" formControlName="correo" placeholder="Correo" required>
    <mat-error *ngIf=" this.signupForm.get('correo').errors?.required">{{ getErrorMessage("correo") }}</mat-error>
    <mat-error *ngIf="this.signupForm.get('correo').dirty && this.signupForm.get('correo').errors?.email">{{ getErrorMessage("correo") }}</mat-error>
    <mat-error *ngIf="this.signupForm.get('correo').errors?.serverError ">{{ this.signupForm.get('correo').errors?.serverError }}</mat-error>

  </mat-form-field>
  <mat-form-field>
    <input matInput type="text" formControlName="fechaNacimiento" placeholder="Fecha de nacimiento (dd/mm/yyyy)" required>
    <mat-error *ngIf="this.signupForm.get('fechaNacimiento').errors?.required">{{ getErrorMessage("fechaNacimiento") }}</mat-error>
    <mat-error *ngIf="this.signupForm.get('fechaNacimiento').errors?.pattern">{{ getErrorMessage("fechaNacimiento") }}</mat-error>

  </mat-form-field>
  <mat-form-field >
    <input matInput  [type]="hide ? 'password' : 'text'" [formControl]="passwordFormControl" placeholder="Contraseña" required (change)="this.confirmPasswordFormControl.setValue('')" >
    <mat-error *ngIf=" passwordFormControl.errors?.required">{{ getErrorMessage("password") }}</mat-error>
    <mat-error *ngIf=" passwordFormControl.errors?.pattern">{{ getErrorMessage("password") }}</mat-error>
    <button class="fondo" mat-icon-button matSuffix (click)="hide = !hide" [attr.aria-label]="'Hide password'" [attr.aria-pressed]="hide">
      <mat-icon>{{hide ? 'visibility_off' : 'visibility'}}</mat-icon>
    </button>
    
  </mat-form-field>
  <mat-form-field >
    <input matInput  [type]="hide2 ? 'password' : 'text'" [formControl]="confirmPasswordFormControl" required placeholder="Repita contraseña" >
    <mat-error *ngIf="this.confirmPasswordFormControl.dirty && this.confirmPasswordFormControl.errors?.noMatch"> {{getErrorMessage("confirmPassword")}} </mat-error>   
    <button class="fondo" mat-icon-button matSuffix (click)="hide2 = !hide2" [attr.aria-label]="'Hide password'" [attr.aria-pressed]="hide2">
      <mat-icon>{{hide2 ? 'visibility_off' : 'visibility'}}</mat-icon>
    </button>
  </mat-form-field>
  
  <mat-form-field appearance="fill">
    <mat-label>Rol</mat-label>
    <mat-select matNativeControl required formControlName="rol" (selectionChange)="obtenerRol($event.value)">
      <mat-option *ngFor="let rol of rolesList | keyvalue" [value]="rol.key"value="admin">{{ rol.value }}</mat-option>
    </mat-select>
    <mat-error *ngIf="this.signupForm.get('rol').errors?.required"> {{ getErrorMessage("rol") }}</mat-error>

  </mat-form-field>
  <mat-form-field appearance="fill">
    <mat-label>Centro educativo</mat-label>
    <mat-select matNativeControl required formControlName="codigoCentro" (selectionChange)="obtenerFP($event.value)" > 
      <mat-option *ngFor="let centro of centroList | keyvalue" [value]="centro.key" >{{ centro.value }}</mat-option>
    </mat-select>
    <mat-error *ngIf="this.signupForm.get('codigoCentro').errors?.required"> {{ getErrorMessage("codigoCentro") }}</mat-error>

  </mat-form-field>
  <mat-form-field appearance="fill">
    <mat-label>FP</mat-label>
    <mat-select matNativeControl required formControlName="fpDual">
      <mat-option *ngFor="let fp of fpList | keyvalue" [value]="fp.key">{{ fp.value }}</mat-option>
    </mat-select>
    <mat-error *ngIf="this.signupForm.get('fpDual').errors?.required"> {{ getErrorMessage("fpDual") }}</mat-error>

  </mat-form-field>
  
  <mat-form-field appearance="fill">
    <mat-label>G&eacute;nero</mat-label>
    <mat-select matNativeControl required formControlName="genero">
      <mat-option  value="masculino">Masculino</mat-option>
      <mat-option  value="femenino" >Femenino</mat-option>
    </mat-select>
    <mat-error *ngIf="this.signupForm.get('genero').errors?.required">{{ getErrorMessage("genero") }}</mat-error>
  </mat-form-field>
  <mat-form-field *ngIf="this.numero==4; else anotherRol" required>
    <input matInput type="text" [formControl]="formGroupProfesor" placeholder="Departamento" >
    <mat-error *ngIf="formGroupProfesor.errors?.required ">{{ getErrorMessage("formGroupProfesor") }}</mat-error>
    <mat-error *ngIf="formGroupProfesor.errors?.minlength">{{ getErrorMessage("formGroupProfesor") }}</mat-error>
  </mat-form-field>
  <ng-template  #anotherRol>
    <mat-form-field *ngIf="this.numero==5; else rolTutorEmpresa" required>
      <input matInput type="text" [formControl]="numeroExpediente" placeholder="Número de expediente" >
      <mat-error *ngIf=" numeroExpediente.errors?.required">{{ getErrorMessage("numeroExpediente") }}</mat-error>
      <mat-error *ngIf=" numeroExpediente.errors?.minlength">{{ getErrorMessage("numeroExpediente") }}</mat-error>
      <mat-error *ngIf=" numeroExpediente.errors?.serverError">{{ numeroExpediente.errors?.serverError }}</mat-error>
    </mat-form-field>
  </ng-template>
  <ng-template  #rolTutorEmpresa>
    <mat-form-field [formGroup]="formGroupTutor" *ngIf="this.numero==3">
        <input  matInput type="text" required formControlName="moduloEmpresa"  placeholder="Modulo de la empresa" >
        <mat-error *ngIf=" this.formGroupTutor.get('moduloEmpresa').errors?.required">{{ getErrorMessage("moduloEmpresa") }}</mat-error>
        <mat-error *ngIf=" this.formGroupTutor.get('moduloEmpresa').errors?.minlength">{{ getErrorMessage("moduloEmpresa") }}</mat-error>
      </mat-form-field >
      <mat-form-field [formGroup]="formGroupTutor" *ngIf="this.numero==3" appearance="fill">
        <mat-label>Empresas</mat-label>
        <mat-select matNativeControl required formControlName="cifEmpresa">
          <mat-option *ngFor="let empresa of empresaList | keyvalue" [value]="empresa.key">{{ empresa.value }}</mat-option>
        </mat-select>
        <mat-error *ngIf="this.formGroupTutor.get('cifEmpresa').errors?.required"> {{ getErrorMessage("cifEmpresa") }}</mat-error>
      </mat-form-field>
  </ng-template>
  <button class="boton-envio" [disabled]="!signupForm.valid" type="submit">
    <span>Registrar Usuario</span>
  </button>
  <mat-label></mat-label>
</form>

